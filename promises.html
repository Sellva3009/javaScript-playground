<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promises</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Promises playground</h1>

    <script>
        function makePizza(toppings = []){
            // const pizzaPromise = new Promise(function(resolve, reject) {
            return new Promise(function( resolve, reject) {
                if (toppings.includes('pineapple')) {
                    reject('Oh no! REMOVE Pineapple');
                }
                // const amountOfTimeToBake = 500 + (toppings.length * 300);
                setTimeout(() => {
                    resolve(`Your pizza is ready with ${toppings.join(', ')}`);
                }, 1000);
                // setTimeout(() => {
                //     resolve(`Your pizza is ready with ${toppings.join(', ')}`);
                // }, amountOfTimeToBake);
            });
            // return pizzaPromise;
        }

        // const pizza = makePizza();
        // console.log(pizza);

        // const pepperoniPromise = makePizza(['pepperoni']);
        // const canadianPromise = makePizza(['pepperoni', 'mushrooms', 'onions']);
        
        // console.log(pepperoniPromise, canadianPromise);

        // console.log('Starting');
        // pepperoniPromise.then(function (pizza) {
        //     console.log('Ahh go it');
        //     console.log(pizza);
        // });
        // canadianPromise.then(function (pizza) {
        //     console.log('Ahh go it');
        //     console.log(pizza);
        // });
        // console.log('Ending');

        // console.log('First');
        // makePizza(['pepperoni'])
        //     .then(function (pizza) {
        //         console.log(pizza);
        //         return makePizza(['pepperoni', 'mushrooms', 'onions']);
        //     })
        //     .then(function (pizza) {
        //         console.log(pizza);
        //         return makePizza(['ham', 'cheese']);
        //     })
        //     .then(function (pizza) {
        //         console.log(pizza);
        //         return makePizza();
        //     })
        //     .then(function (pizza) {
        //         console.log(pizza);
        //         return makePizza(['one', 'two', 'three', 'four', 'one', 'two', 'three', 'four', 'one', 'two', 'three', 'four'])
        //     })
        //     .then(function (pizza) {
        //         console.log('All done! here is your last pizza');
        //         console.log(pizza);
        //     })

        // console.log('Right After');

        // Run multiple promise concurrently
        // const pizzaPromise1 = makePizza(['hot peppers', 'onion', 'feta']);
        // const pizzaPromise2 = makePizza(['one', 'two', 'three', 'four', 'one', 'two', 'three', 'four', 'one', 'two', 'three', 'four']);
        // const pizzaPromise3 = makePizza(['ham', 'cheese']);

        // const dinnerPromise = Promise.all([pizzaPromise1, pizzaPromise2, pizzaPromise3]);

        // dinnerPromise.then(function(pizzas) {
        //     console.log(pizzas);
        //     // destructing
        //     const [hottie, garbagePail, hamAndCheese] = pizzas;
        //     console.log(hottie, garbagePail, hamAndCheese);
        // })

        // dinnerPromise.then(([hottie, garbagePail, hamAndCheese]) => (console.log(hottie, garbagePail, hamAndCheese))
        // )

        // const firstPizzaPromise = Promise.race([pizzaPromise1, pizzaPromise2, pizzaPromise3]);

        // firstPizzaPromise.then(pizza => {
        //     console.log('You must be hungry. here is the first one ready');
        //     console.log(pizza);
        // })

        // Error handling
        function handleError(err) {
            console.log(err);
        }

        // makePizza(['ham', 'pineapple'])
        //     .then( pizza => console.log(pizza))
        //     .catch(handleError)

        // handing multiple request
        // below one stops when anyone of the function failed
        // makePizza(['pepperoni'])
        //     .then(function (pizza) {
        //         console.log(pizza);
        //         return makePizza(['pepperoni', 'mushrooms', 'onions']);
        //     })
        //     .then(function (pizza) {
        //         console.log(pizza);
        //         return makePizza(['ham', 'cheese']);
        //     })
        //     .then(function (pizza) {
        //         console.log(pizza);
        //         return makePizza(['pineapple']);
        //     })
        //     .then(function (pizza) {
        //         console.log(pizza);
        //         return makePizza(['one', 'two', 'three', 'four', 'one', 'two', 'three', 'four', 'one', 'two', 'three', 'four'])
        //     })
        //     .then(function (pizza) {
        //         console.log('All done! here is your last pizza');
        //         console.log(pizza);
        //     }).catch(handleError);
        
        // handling multiple error handling with Promise.allSettled
        const p1 = makePizza(['hot peppers', 'onion', 'feta']);
        const p2 = makePizza(['one', 'two', 'three', 'four', 'one', 'two', 'three', 'four', 'one', 'two', 'three', 'pineapple', 'four']);
        const p3 = makePizza(['ham', 'cheese']);

        const dinnerPromise2 = Promise.allSettled([p1, p2, p3]);

        dinnerPromise2.then(results => {
            console.log(results);
        })


    </script>
</body>
</html>